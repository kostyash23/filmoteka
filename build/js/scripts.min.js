"use strict";var renderFilms,genres,pageNumber,URL_POPULAR="https://api.themoviedb.org/3/movie/popular?api_key=9675092798f3a490a8c4d8f2cf77169b&language=en-US&page=",URL_GENRES="https://api.themoviedb.org/3/genre/movie/list?api_key=9675092798f3a490a8c4d8f2cf77169b&language=en-US",filmList=document.querySelector(".filmList");filmList.setAttribute("data-name","home");var createCardFunc=function(e,t,a){var n=document.createElement("li");n.classList.add("filmList__item"),n.setAttribute("data-id",a);var i=document.createElement("img");i.classList.add("filmList__poster"),i.setAttribute("alt",t),i.setAttribute("src","https://image.tmdb.org/t/p/w500"+e),n.append(i);var o=document.createElement("p");return o.classList.add("item__name"),o.textContent=t,n.append(o),n},fetchPopularMoviesList=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;fetch("".concat(URL_POPULAR+e)).then(function(e){return e.json()}).then(function(e){renderFilms=e.results;var o=document.createDocumentFragment();renderFilms.forEach(function(e){var t=e.backdrop_path,a=e.original_title,n=e.release_date.substr(0,4)?"(".concat(e.release_date.substr(0,4),")"):"",i=e.id;o.append(createCardFunc(t,"".concat(a," ").concat(n),i))}),filmList.innerHTML="",filmList.append(o),filmList.addEventListener("click",activeDetailsPageListener)}).catch(function(e){var t=document.createDocumentFragment(),a=document.createElement("h2");a.classList.add("filmList__error"),a.textContent="Oops, something went wrong",t.append(a);var n=document.createElement("h3");n.classList.add("filmList__error"),n.textContent="Please, try again later",t.append(n);var i=document.createElement("p");i.classList.add("filmList__error"),i.textContent=e,t.append(i),filmList.innerHTML="",filmList.append(t)})},fetchGenres=function(){fetch(URL_GENRES).then(function(e){return e.json()}).then(function(e){genres=e.genres}).catch(console.log)};fetchPopularMoviesList(),fetchGenres();var inputValue=document.querySelector(".search-form__input").value,input=document.querySelector(".search-form__input"),form=document.querySelector(".search-form"),btnPrev=document.querySelector(".page_prev"),btnNext=document.querySelector(".page_next"),btnPageNumber=document.querySelector(".number_page"),containerBtn=document.querySelector(".button_page"),findFilms=[];function fetchFilms(){fetch("https://api.themoviedb.org/3/search/movie?api_key=9e008f5d338cd1f22f432e50e537417d&language=en-US&query=".concat(inputValue,"&page=").concat(pageNumber,"&include_adult=false")).then(function(e){return e.json()}).then(function(e){if(findFilms=e.results,e.results.length)document.querySelector(".filmList").innerHTML="",e.results.map(function(e){var t="".concat(e.backdrop_path),a=e.release_date?"(".concat(e.release_date.substr(0,4),")"):"",n="".concat(e.title," ").concat(a),i=e.id;btnPageNumber.classList.add("active"),btnNext.classList.add("active"),document.querySelector(".filmList").appendChild(createCardFunc(t,n,i))});else{var t=document.createElement("p");t.classList.add("warning"),t.textContent="Enter correct query!!!",document.querySelector(".search").insertBefore(t,document.querySelector(".filmList")),setTimeout(function(){t.remove()},2e3)}}).catch(function(e){var t=document.createDocumentFragment(),a=document.createElement("h2");a.classList.add("filmList__error"),a.textContent="Oops, something went wrong",t.append(a);var n=document.createElement("h3");n.classList.add("filmList__error"),n.textContent="We could not find movie",t.append(n);var i=document.createElement("p");i.classList.add("filmList__error"),i.textContent="Try again",t.append(i),btnPrev.classList.add("disable"),btnPageNumber.classList.add("disable"),btnNext.classList.add("disable"),filmList.innerHTML="",filmList.append(t),console.log(e)})}function searchFilms(e){e.preventDefault(),inputValue=input.value,pageNumber=1,btnPageNumber.innerText=pageNumber,btnPrev.classList.remove("active"),btnPrev.classList.add("disable"),fetchFilms(),e.target.reset()}function scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}function plaginationNavigation(e){e.target.classList.contains("page_prev")&&1<pageNumber&&(scrollToTop(),btnPageNumber.innerText--,pageNumber--,inputValue?fetchFilms():fetchPopularMoviesList(pageNumber),1===pageNumber&&(btnPrev.classList.remove("active"),btnPrev.classList.add("disable"))),e.target.classList.contains("page_next")&&(scrollToTop(),btnPrev.classList.add("active"),btnPageNumber.innerText++,pageNumber++,inputValue?fetchFilms():fetchPopularMoviesList(pageNumber))}(pageNumber=1)===(btnPageNumber.innerText=pageNumber)&&btnPrev.classList.add("disable"),form.addEventListener("submit",searchFilms),containerBtn.addEventListener("click",plaginationNavigation);var selectFilm,btnHome=document.querySelector(".header__link--home"),btnLibrary=document.querySelector(".header__link--library"),sectionMain=document.querySelector(".home-page"),sectionCard=document.querySelector(".film-card"),sectionTeam=document.querySelector(".myTeam"),sectionLibrary=document.querySelector("main > .myFilmLibraryPage__container"),btnFavourites=document.querySelector(".myFilmLibraryPage__buttonFavourites"),btnQueue=document.querySelector(".myFilmLibraryPage__buttonQueue"),btnAddToFavourite=document.querySelector(".card-details__AddToFavourite"),btnRemoveFromFavourite=document.querySelector(".card-details__RemoveFromFavourite"),btnAddToQueue=document.querySelector(".card-details__AddToQueue"),btnRemoveFromQueue=document.querySelector(".card-details__RemoveFromQueue"),headerNav=document.querySelector(".header__nav"),headerLogo=document.querySelector(".header__logo"),footLink=document.querySelector(".footer__link");function activeHomePage(){sectionTeam.classList.add("non-active-section"),sectionCard.classList.add("non-active-section"),sectionLibrary.classList.add("non-active-section"),sectionMain.classList.remove("non-active-section")}function activeTeamPage(){sectionTeam.classList.remove("non-active-section"),sectionCard.classList.add("non-active-section"),sectionLibrary.classList.add("non-active-section"),sectionMain.classList.add("non-active-section")}function activeLibraryPage(){sectionTeam.classList.add("non-active-section"),sectionCard.classList.add("non-active-section"),sectionMain.classList.add("non-active-section"),sectionLibrary.classList.remove("non-active-section"),drawWatchedFilmList()}function activeDetailsPageListener(e){sectionCard.classList.remove("non-active-section"),sectionMain.classList.add("non-active-section"),sectionLibrary.classList.add("non-active-section"),sectionTeam.classList.add("non-active-section"),"home"===e.currentTarget.dataset.name?activeDetailsPage(e.target.dataset.id,!1):"favourites"!==e.currentTarget.dataset.name&&"queue"!==e.currentTarget.dataset.name||activeDetailsPage(e.target.dataset.id,!0)}function activeDetailsPage(t,e){var a,n;if(e){try{var i=localStorage.getItem("filmsWatched");i&&(a=JSON.parse(i),selectFilm=a.find(function(e){return e.id===Number(t)}))}catch(e){console.error(e)}if(!selectFilm)try{var o=localStorage.getItem("filmsQueue");o&&(n=JSON.parse(o),selectFilm=n.find(function(e){return e.id===Number(t)}))}catch(e){console.error(e)}}else(selectFilm=renderFilms.find(function(e){return e.id===Number(t)}))||(selectFilm=findFilms.find(function(e){return e.id===Number(t)}));showDetails(selectFilm)}function chooseActiveLink(e){if(e.preventDefault(),e.target.classList.contains("header__link")){var t=headerNav.querySelector(".header__link--active");t&&t.classList.remove("header__link--active"),e.target.classList.add("header__link--active")}}activeHomePage(),btnHome.addEventListener("click",activeHomePage),headerLogo.addEventListener("click",activeHomePage),btnLibrary.addEventListener("click",activeLibraryPage),headerNav.addEventListener("click",chooseActiveLink),footLink.addEventListener("click",footLinkHandle);var filmsQueue,filmsWatched,btnFix=document.querySelector(".button-fix"),detailsCard=document.querySelector(".card-details"),actionBtnsForm=document.querySelector(".card-details__actions"),posterImg=detailsCard.querySelector(".card-details__img"),cardDetailsTitle=detailsCard.querySelector(".card-details__title"),cardDetailsVotes=detailsCard.querySelector(".card-details__votes--value"),cardDetailsPopularity=detailsCard.querySelector(".card-details__popularity--value"),cardDetailsName=detailsCard.querySelector(".card-details__name--value"),cardDetailsGenre=detailsCard.querySelector(".card-details__genre--value"),cardDetailsAbout=detailsCard.querySelector(".card-details__about--text"),addToFavBtn=actionBtnsForm.querySelector("button[data-action='add-to-favorite']"),delFromFavBtn=actionBtnsForm.querySelector("button[data-action='delete-from-favorite']"),addToQueueBtn=actionBtnsForm.querySelector("button[data-action='add-to-queue']"),delFromQueueBtn=actionBtnsForm.querySelector("button[data-action='delete-from-queue']");try{filmsQueue=localStorage.getItem("filmsQueue")?JSON.parse(localStorage.getItem("filmsQueue")):[]}catch(e){throw e}try{filmsWatched=localStorage.getItem("filmsWatched")?JSON.parse(localStorage.getItem("filmsWatched")):[]}catch(e){throw e}var toggleBtn=function(e,t){e.classList.remove("hide"),e.classList.add("show"),t.classList.remove("show"),t.classList.add("hide")},monitorButtonStatusText=function(){filmsQueue&&filmsQueue.find(function(e){return e.id===selectFilm.id})?toggleBtn(delFromQueueBtn,addToQueueBtn):toggleBtn(addToQueueBtn,delFromQueueBtn),filmsWatched&&filmsWatched.find(function(e){return e.id===selectFilm.id})?toggleBtn(delFromFavBtn,addToFavBtn):toggleBtn(addToFavBtn,delFromFavBtn)},toggleToQueue=function(e){var t=e.target;if("add-to-queue"===t.parentNode.dataset.action||"delete-from-queue"===t.parentNode.dataset.action){filmsQueue||(filmsQueue=[]),filmsQueue.find(function(e){return e.id===selectFilm.id})?filmsQueue=filmsQueue.filter(function(e){return e.id!==selectFilm.id}):filmsQueue.push(selectFilm);try{filmsQueue.length?localStorage.setItem("filmsQueue",JSON.stringify(filmsQueue)):localStorage.removeItem("filmsQueue")}catch(e){throw e}monitorButtonStatusText()}},toggleToWatched=function(e){var t=e.target;if("add-to-favorite"===t.parentNode.dataset.action||"delete-from-favorite"===t.parentNode.dataset.action){filmsWatched||(filmsWatched=[]),filmsWatched.find(function(e){return e.id===selectFilm.id})?filmsWatched=filmsWatched.filter(function(e){return e.id!==selectFilm.id}):filmsWatched.push(selectFilm);try{filmsWatched.length?localStorage.setItem("filmsWatched",JSON.stringify(filmsWatched)):localStorage.removeItem("filmsWatched")}catch(e){throw e}monitorButtonStatusText()}},showDetails=function(e){document.body.scrollTop=0,document.documentElement.scrollTop=0,detailsCard.dataset.id=e.id,posterImg.src="https://image.tmdb.org/t/p/w500".concat(e.poster_path),posterImg.alt=e.original_title,cardDetailsTitle.textContent=e.original_title,cardDetailsVotes.textContent="".concat(e.vote_average," / ").concat(e.vote_count),cardDetailsPopularity.textContent=e.popularity,cardDetailsName.textContent=e.original_title;var t=e.genre_ids.map(function(e){return e}),a=genres.filter(function(e){return t.includes(e.id)}).map(function(e){return e.name});cardDetailsGenre.textContent=a.join(", "),cardDetailsAbout.textContent=e.overview,monitorButtonStatusText()};function scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})}actionBtnsForm.addEventListener("click",toggleToQueue),actionBtnsForm.addEventListener("click",toggleToWatched),window.onscroll=function(){40<document.documentElement.scrollTop?btnFix.style.display="block":btnFix.style.display="none"},btnFix.addEventListener("click",scrollToTop);var films=document.querySelector(".myFilmLibraryPage__film-card"),favouriteButton=document.querySelector(".myFilmLibraryPage__buttonFavourites"),queueButton=document.querySelector(".myFilmLibraryPage__buttonQueue"),createLibraryCardFunc=function(e,t,a,n){var i=document.createElement("li");i.classList.add("film"),i.setAttribute("data-id",a);var o=document.createElement("img");o.setAttribute("src","https://image.tmdb.org/t/p/w500"+e),o.setAttribute("alt",t);var r=document.createElement("p");r.classList.add("myFilmLibraryPage__film-title"),r.textContent=t;var c=document.createElement("div");return c.classList.add("myFilmLibraryPage__rating"),c.textContent=n,i.appendChild(o),i.appendChild(r),i.appendChild(c),i},drawWatchedFilmList=function(){favouriteButton.classList.remove("button__white"),favouriteButton.classList.add("button__colored"),queueButton.classList.remove("button__colored"),queueButton.classList.add("button__white");var t=document.createDocumentFragment();if(null===localStorage.getItem("filmsWatched")){var e=document.createDocumentFragment(),a=document.createElement("h2");return a.classList.add("storage__empty"),a.textContent="You do not have favourite movies. Add them.",e.append(a),films.innerHTML="",void films.append(e)}var n=JSON.parse(localStorage.getItem("filmsWatched"));if(0===n.length){var i=document.createDocumentFragment(),o=document.createElement("h2");return o.classList.add("storage__empty"),o.textContent="You do not have favourite movies. Add them.",i.append(o),films.innerHTML="",void films.append(i)}n.forEach(function(e){return t.append(createLibraryCardFunc(e.backdrop_path,e.original_title,e.id,e.vote_average))}),films.setAttribute("data-name","favourites"),films.innerHTML="",films.append(t),films.addEventListener("click",activeDetailsPageListener)},drawQueueFilmList=function(){queueButton.classList.remove("button__white"),queueButton.classList.add("button__colored"),favouriteButton.classList.remove("button__colored"),favouriteButton.classList.add("button__white");var t=document.createDocumentFragment();if(null===localStorage.getItem("filmsQueue")){var e=document.createDocumentFragment(),a=document.createElement("h2");return a.classList.add("storage__empty"),a.textContent="You do not have to queue movies to watch. Add them.",e.append(a),films.innerHTML="",void films.append(e)}var n=JSON.parse(localStorage.getItem("filmsQueue"));if(0===n.length){var i=document.createDocumentFragment(),o=document.createElement("h2");return o.classList.add("storage__empty"),o.textContent="You do not have to queue movies to watch. Add them.",i.append(o),films.innerHTML="",void films.append(i)}n.forEach(function(e){return t.append(createLibraryCardFunc(e.backdrop_path,e.original_title,e.id,e.vote_average))}),films.setAttribute("data-name","queue"),films.innerHTML="",films.append(t),films.addEventListener("click",activeDetailsPageListener)};favouriteButton.addEventListener("click",drawWatchedFilmList),queueButton.addEventListener("click",drawQueueFilmList);var myTeam=document.querySelector(".myTeam"),OUR_TEAM=[{name:"Nikolay Mykhailenko",gitHubLink:"https://www.github.com/HardRye",facebookLink:"https://www.facebook.com/profile.php?id=100014592882557",linkedInLink:"https://www.linkedin.com/in/nikolay-m"},{name:"Anna Kholod",gitHubLink:"https://www.github.com/annakholod",facebookLink:"https://www.facebook.com/profile.php?id=100023500111911",linkedInLink:"https://www.linkedin.com/in/anna-kholod-b8930578/"},{name:"Kostya Shmotoloha",gitHubLink:"https://www.github.com/kostyash23",facebookLink:"https://www.facebook.com/kostia.shmotoloha",linkedInLink:"https://www.linkedin.com/in/kostiash/"},{name:"Alexandr Kozyr",gitHubLink:"https://www.github.com/AlexxxxK",facebookLink:"#",linkedInLink:"https://www.linkedin.com/in/oleksandr-kozyr/"},{name:"Maksym Osadchuk",gitHubLink:"https://www.github.com/maximusII",facebookLink:"https://www.facebook.com/maxym.osadchuk",linkedInLink:"https://www.linkedin.com/in/maksym-osadchuk-869a80123/"}];function footLinkHandle(){activeTeamPage();var c=document.createDocumentFragment(),e=document.createElement("ul");e.classList.add("new__class","contacts"),OUR_TEAM.forEach(function(e){var t=document.createElement("li");t.classList.add("person");var a=document.createElement("p");a.classList.add("person__name"),a.textContent=e.name;var n=document.createElement("div");n.classList.add("person__socials");var i=document.createElement("a");i.classList.add("person__socials-icon","person__socials-icon--github"),i.setAttribute("href",e.gitHubLink),i.setAttribute("target","_blank");var o=document.createElement("a");o.classList.add("person__socials-icon","person__socials-icon--facebook"),o.setAttribute("href",e.facebookLink),o.setAttribute("target","_blank");var r=document.createElement("a");r.classList.add("person__socials-icon","person__socials-icon--linkedin"),r.setAttribute("href",e.linkedInLink),r.setAttribute("target","_blank"),n.append(i,o,r),t.append(a,n),c.append(t)}),e.append(c),myTeam.innerHTML="",myTeam.appendChild(e)}